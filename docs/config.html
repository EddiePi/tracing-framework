<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Brownsys Tracing Framework Documentation</title>

        <link rel="stylesheet" href="http://brownsys.github.io/tracing-framework/css/bootstrap.min.css">
        <link rel="stylesheet" href="http://brownsys.github.io/tracing-framework/css/font-awesome.min.css">
        <link rel="stylesheet" href="http://brownsys.github.io/tracing-framework/css/highlight.dark.css">
        <link rel="stylesheet" href="http://brownsys.github.io/tracing-framework/css/main.css">
            <link href="http://fonts.googleapis.com/css?family=Abel:400|Oswald:300,400,700" media="all" rel="stylesheet" type="text/css">
    </head>
    <body>

        <header class="navbar navbar-default navbar-fixed-top">

            <a class="navbar-brand" href="http://brownsys.github.io/tracing-framework/">
                Brownsys Tracing Framework Documentation
                            </a>

                            <a href="https://github.com/brownsys/tracing-framework">
                    <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png">
                </a>
            
        </header>

        <main class="container-fluid">
            <div class="row">

                
                    <nav id="sidebar" class="col-sm-4 col-lg-3" role="navigation">

                 <!--       <ul class="nav nav-pills nav-stacked">
                                                    </ul> -->

                        <ul>
                                                            <li>
                            		                                        <a class="sectionlink" href="http://brownsys.github.io/tracing-framework/">                        
                                                                        Overview
                                                                            </a>
                                    
                                    <ul>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/docs/projects/tracingplane.html">
                                                    TracingPlane
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/docs/projects/xtrace.html">
                                                    X-Trace
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/docs/projects/retro.html">
                                                    Retro
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/docs/projects/pivottracing.html">
                                                    Pivot Tracing
                                                </a>
                                            </li>
                                                                            </ul>
                                </li>
                                                            <li>
                            		                                        <a class="sectionlink" href="http://brownsys.github.io/tracing-framework/">                        
                                                                        Tutorials
                                                                            </a>
                                    
                                    <ul>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/docs/tutorials/gettingstarted.html">
                                                    Getting Started
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/docs/tutorials/xtrace.html">
                                                    Using X-Trace
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/docs/tutorials/retro.html">
                                                    Using Retro
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/docs/tutorials/pivottracing.html">
                                                    Using PivotTracing
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/docs/tutorials/baggage.html">
                                                    Adding Baggage To Your System
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/docs/tutorials/aspects.html">
                                                    Using Automatic Instrumentation
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/docs/tutorials/tracingapplication.html">
                                                    Using Baggage Yourself
                                                </a>
                                            </li>
                                                                            </ul>
                                </li>
                                                            <li>
                            		                                        <a class="sectionlink" href="http://brownsys.github.io/tracing-framework/tracingplane">                        
                                                                        Tracing Plane
                                                                            </a>
                                    
                                    <ul>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/tracingplane/pubsub">
                                                    PubSub
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/tracingplane/client">
                                                    Baggage
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/tracingplane/aspects">
                                                    Auto-Baggage
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/tracingplane/dynamic">
                                                    Dynamic Instrumentation
                                                </a>
                                            </li>
                                                                            </ul>
                                </li>
                                                            <li>
                            		                                        <a class="sectionlink" href="http://brownsys.github.io/tracing-framework/xtrace">                        
                                                                        X-Trace
                                                                            </a>
                                    
                                    <ul>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/xtrace/client">
                                                    Client Library
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/xtrace/aspects">
                                                    Automatic Instrumentation
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/xtrace/server">
                                                    Report Server
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/xtrace/visualization">
                                                    Visualization
                                                </a>
                                            </li>
                                                                            </ul>
                                </li>
                                                            <li>
                            		                                    Retro
                                    
                                    <ul>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/retro/resources">
                                                    Resource Instrumentation
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/retro/aspects">
                                                    Auto-Instrumentation
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/retro/aggregation">
                                                    Aggregation
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/retro/throttling">
                                                    Tenant Throttling
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/retro/visualization">
                                                    Visualization
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/docs/retro/configuration.html">
                                                    Configuration
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/docs/retro/retrowithxtrace.html">
                                                    Retro + X-Trace
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/docs/retro/lockinstrumentation.html">
                                                    Instrumentation for Locks
                                                </a>
                                            </li>
                                                                            </ul>
                                </li>
                                                            <li>
                            		                                    Pivot Tracing
                                    
                                    <ul>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/pivottracing/client">
                                                    Client Library
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/pivottracing/agent">
                                                    Pivot Tracing Agent
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/pivottracing/privileged">
                                                    Privileged Classes
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/pivottracing/test">
                                                    Examples
                                                </a>
                                            </li>
                                                                            </ul>
                                </li>
                                                            <li>
                            		                                    Reference
                                    
                                    <ul>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/docs/config.html">
                                                    Configuration
                                                </a>
                                            </li>
                                                                                    <li class="">
                                                <a class="pagelink" href="http://brownsys.github.io/tracing-framework/docs/tools.html">
                                                    Tools and Executables
                                                </a>
                                            </li>
                                                                            </ul>
                                </li>
                                                    </ul>


                    </nav>

                

                <section id="content" class="col-sm-8 col-lg-9">
                    <h1 id="configuration">Configuration</h1>
<p>All of the tracing framework projects use the <a href="https://github.com/typesafehub/config">Typesafe Config</a> for configuration.</p>
<p>Each project has a few configuration values you can set, defined in per-project <code>reference.conf</code> files located in the <code>src/main/resources</code> folder.  The full configuration is listed below.</p>
<p>To override a configuration value, create a file <code>application.conf</code> and place it somewhere on the classpath (for example, co-locate it with your usual Hadoop configuration files).  Anything specified in the application.conf file will override default configuration values.</p>
<p>The two configuration options that are particularly relevant are:</p>
<ul>
<li><code>xstore.server.datastore.dir</code> specifies where the X-Trace server should persist the reports it receives (if you wish to use X-Trace).  By default, it will create a folder in the directory where X-Trace is started.  Consider setting this to something more permanent.  This configuration value is only necessary on the machine that runs the X-Trace server</li>
<li><code>pubsub.server.hostname</code> specifies the hostname of the machine running the pub sub server.  All projects use pubsub for communication and must have the correct value for this.  By default, this is the local host, which is fine for a single-machine set up or just trying things out.</li>
</ul>
<p>The following are all configurations:</p>
<pre><code>// Dynamic Instrumentation Config
dynamic-instrumentation {
    use_jdwp = false        // If true, will try to use JDWP dynamic instrumentation instead of agent lib.  JDWP is tentatively deprecated
}

// Pub Sub Config
pubsub {

  server {
    hostname = "127.0.0.1"
    bindto = "0.0.0.0"
    port = 5563
  }

  topics {
    control = "_"
  }

}

// Pivot Tracing Agent config
pivot-tracing {
    agent = {
        use_baggage = true          // Regardless of whether the system is baggage enabled or not, setting to false will disable using it
        use_dynamic = true          // Should the agent use dynamic instrumentation?
        report_interval_ms = 1000   // Report every 1 second
    }
}

// Pivot Tracing Common Config
pivot-tracing {
    pubsub = {
       server = ${pubsub.server}
       commands_topic = "PTcommands"
       results_topic = "PTresults"
       status_topic = "PTstatus"
    }
}

// X-Trace Client Config
xtrace {

    client {
        reporting {
            on                  = true      # is XTrace reporting globally enabled
            default             = true      # for a logging class, it is on or off by default
            enabled             = [ "com.example.EnabledClass",     # list of agent names for whom logging is enabled,
                                        "randomEnabledAgentName" ]      #  overriding setting in xtrace.client.reporting.default
            disabled            = [ "com.example.DisabledClass",    # list of agent names for whom logging is disabled
                                        "randomDisabledAgentName" ]     #  overriding setting in xtrace.client.reporting.default
            discoverymode       = false     # discovery mode is super verbose. whenever a log statement is encountered, a task will be started.
        }
    }

}

// X-Trace Common Config
xtrace {

    pubsub {
        topic = "xtrace"        # Topic on which X-Trace reports are published
    }

}

// X-Trace Server Config
xtrace {

    server {
        bind-hostname = 0.0.0.0 # hostname to bind the webserver to

        database-update-interval-ms = 1000

        webui {
            port                    = 4080
        }

        datastore {
            dir                     = "./xtrace-data"   # location of xtrace storage
            buffer-size             = 65536             # buffer size for each task writer
            cache-size              = 1000              # number of file handles to cache for writing tasks
            cache-timeout           = 30000             # cache eviction timeout for file handles
        }
    }

}

// Retro Reporting Config
resource-reporting {

    # settings for the aggregation component of resource reporting.  consumption can be aggregated without reporting
    aggregation {
        active                          = true                  # aggregation is on by default
        disk-cache-threshold            = 120000000             # bytes per second threshold for a disk read to be logged as a disk cache read
        small-read                      = 131072                # a small read is one that is &lt;= 128kb
        seek-threshold                  = 10000000              # a small read is a seek if it is slower than 10 ms (10,000,000 ns)

        # per-resource settings
        enabled {
            disk                        = ${resource-reporting.aggregation.active}  # disk aggregation is enabled by default; can set to true or false
            disk-cache                  = ${resource-reporting.aggregation.active}  # disk-cache aggregation is enabled by default; can set to true or false
            network                     = ${resource-reporting.aggregation.active}  # network aggregation is enabled by default; can set to true or false
            cpu                         = ${resource-reporting.aggregation.active}  # cpu aggregation is enabled by default; can set to true or false
            hdfs                        = ${resource-reporting.aggregation.active}  # hdfs aggregation is enabled by default; can set to true or false
            locks                       = ${resource-reporting.aggregation.active}  # locks aggregation is enabled by default; can set to true or false
            queue                       = ${resource-reporting.aggregation.active}  # queue aggregation is enabled by default; can set to true or false
            throttlingpoint             = ${resource-reporting.aggregation.active}  # throttling point aggregation is enabled by default; can set to true or false
            batch                       = ${resource-reporting.aggregation.active}  # batch aggregation is enabled by default; can set to true or false
        }
    }

    # settings for the reporting side.  reporting can be disabled or modified separately from aggregation
    reporting {
        active                          = true                  # reporting is on by default. default reporter is zmq
        interval                        = 1000                  # reporting interval in milliseconds

        # reporting settings for the zmq reporter
        zmq {
            topics {
                default                 = "default"             # default topic for reports if none configured
                immediate               = "immediate"           # topic for immediate reports to be published on
                disk                    = "disk"                # topic on which to report disk usage reports
                disk-cache              = "diskcache"           # topic on which to report disk cache usage reports
                network                 = "network"             # topic on which to report network usage reports
                cpu                     = "cpu"                 # topic on which to report cpu usage reports
                hdfs                    = "hdfs"                # topic on which to report hdfs usage reports
                locks                   = "locks"               # topic on which to report locks usage reports
                queue                   = "queue"               # topic on which to report queue usage reports
                throttlingpoint         = "throttlingpoint"     # topic on which to report throttling point usage reports
                batch                   = "batch"               # topic on which to report batch usage reports
            } 
        }

        # reporting settings for the file printer reporter
        printer {
            filename                    = "hdfsreports.tsv"     # default filename for reports file
        }
    }

}

// Retro Resources Config
resource-tracing {

    disk {
        sync-after-write        = false     # set to true to sync to disk after every file write
        sync-threshold          = 0         # number of bytes written before disk sync. only valid if sync-on-write is true.  if 0, will sync after every write
    }

    background {
        heartbeat               = -10       # tenant class for heartbeat background process; set to -1 to disable
        replication             = -11       # tenant class for replication background process; set to -1 to disable
        invalidate              = -12       # tenant class for deleting blocks from disk; set to -1 to disable
        finalize                = -13       # tenant class for finalizing blocks; set to -1 to disable
        recover                 = -14       # tenant class for recovering blocks; set to -1 to disable      
    }

    batch {
        hbase {
            fshlog              = -20       # tenant class for hbase fshlog; set to -1 to disable
        }
    }

}

// Retro Throtting Config
retro {
    throttling {
        topic = "throttlingupdates"                 # topic on which the controller should publish throttling point rates
        schedulertopic = "schedulerupdates"         # topic on which the controller should publish scheduler rates

        default-throttlingpoint = "simple"          # type of throttling point to use.  valid choices: ["simple", "batched-&lt;type&gt;-&lt;batchsize&gt;", "default"]
        throttlingpoints {
            "point-example" = "batched-simple-5"    # configures the "point-example" throttling point to use the 'batched' throttling point type.
        }

        default-throttlingqueue = "locking"         # type of throttling queue to use.  valid choices: ["locking", "delay", "default"]
        throttlingqueues {
            "queue-example" = "delay"               # configures the "queue-example" throttling queue to use the "delay" throttling queue type.
        }

        default-scheduler = "mclock-3"              # default scheduler type to use. valid choices: ["mclock-&lt;concurrency&gt;", "default"]
        schedulers {
            "scheduler-example" = "mclock-5"        # configures the "schedulers-example" scheduler to use the "mclock" scheduler type with a concurrency of 5
        }

        debug {
            mclock = false                          # set to true to print mclock debug messages
        }
    }
}

// Retro Visualization Server Config
resource-reporting {
    visualization {
        webui-port = 4081
    }
}</code></pre>
                </section>

            </div>
        </main>

        <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
        <script src="//yastatic.net/highlightjs/8.2/highlight.min.js"></script>

        <script>
            $(function() {
                $("section>h1").wrap('<div class="page-header" />');
                // Syntax highlighting
                hljs.initHighlightingOnLoad();
            });
        </script>

    </body>
</html>
